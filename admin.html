<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - Projects</title>
    <link rel="stylesheet" href="admin.css" />
    <!-- Firebase SDKs -->
   <script type="module">
      // استيراد الدوال المطلوبة
      import * as admin from "./admin.js";

      // ربط الأحداث بعد تحميل الصفحة
      document.addEventListener("DOMContentLoaded", () => {
        // ربط أزرار لوحة التحكم
        document
          .getElementById("login-btn")
          ?.addEventListener("click", admin.login);
        document
          .getElementById("logout-btn")
          ?.addEventListener("click", admin.logout);
        document
          .getElementById("new-project-btn")
          ?.addEventListener("click", admin.openNewProjectModal);
        document
          .getElementById("search")
          ?.addEventListener("input", admin.searchTable);
        document
          .getElementById("add-project-btn")
          ?.addEventListener("click", admin.addNewProject);
        document
          .getElementById("update-project-btn")
          ?.addEventListener("click", admin.updateProject);

        // ربط أزرار الإغلاق
        document
          .getElementById("close-new-modal")
          ?.addEventListener("click", () =>
            admin.closeModal("new-project-modal")
          );
        document
          .getElementById("close-edit-modal")
          ?.addEventListener("click", () =>
            admin.closeModal("edit-project-modal")
          );

        // إغلاق النوافذ عند الضغط بالخارج
        window.addEventListener("click", (e) => {
          if (e.target.classList.contains("modal")) {
            admin.closeModal("new-project-modal");
            admin.closeModal("edit-project-modal");
          }
        });
      });
    </script>
  </head>
  <body>
    <!-- Login Screen -->
    <div id="login-screen" class="screen">
      <div class="login-container">
        <h1>Admin Dashboard</h1>
        <input type="email" id="email" placeholder="Email" />
        <input type="password" id="password" placeholder="Password" />
        <button id="login-btn">Login</button>
        <p
          id="login-error"
          style="color: #ff4444; margin-top: 15px; display: none"
        ></p>
      </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="screen" style="display: none">
      <header>
        <h1>Projects Management</h1>
        <button id="logout-btn">Logout</button>
      </header>

      <div class="controls">
        <input type="text" id="search" placeholder="Search all fields..." />
        <button id="new-project-btn">New Project</button>
      </div>

      <table id="projects-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Customer</th>
            <th>Project</th>
            <th>Status</th>
            <th>Support</th>
            <th>Deployed</th>
            <th>Support Ends</th>
            <th>Website</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="table-body">
          <!-- Data will be loaded dynamically -->
        </tbody>
      </table>
    </div>

    <!-- New Project Modal -->
    <div id="new-project-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="close-new-modal">&times;</span>
        <h2>New Project</h2>
        <input
          type="text"
          id="new-id"
          placeholder="Document ID (Custom)"
          required
        />
        <input
          type="text"
          id="new-customer"
          placeholder="Customer Name"
          required
        />
        <input
          type="text"
          id="new-project-name"
          placeholder="Project Name"
          required
        />
        <input
          type="text"
          id="new-status"
          placeholder="Project Status (Live/Under Development)"
          value="Live"
          required
        />
        <input
          type="text"
          id="new-support-status"
          placeholder="Support Status (Active/Ended)"
          value="Active"
          required
        />
        <input
          type="text"
          id="new-deployment"
          placeholder="Deployment Date (e.g: 29 December 2025)"
          required
        />
        <input
          type="text"
          id="new-support-end"
          placeholder="Support End Date (e.g: 28 January 2026)"
          required
        />
        <input type="url" id="new-url" placeholder="Website URL" required />
        <button id="add-project-btn">Add Project</button>
      </div>
    </div>

    <!-- Edit Project Modal -->
    <div id="edit-project-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="close-edit-modal">&times;</span>
        <h2>Edit Project</h2>
        <input type="text" id="edit-id" readonly />
        <input
          type="text"
          id="edit-customer"
          placeholder="Customer Name"
          required
        />
        <input
          type="text"
          id="edit-project-name"
          placeholder="Project Name"
          required
        />
        <input
          type="text"
          id="edit-status"
          placeholder="Project Status"
          required
        />
        <input
          type="text"
          id="edit-support-status"
          placeholder="Support Status"
          required
        />
        <input
          type="text"
          id="edit-deployment"
          placeholder="Deployment Date"
          required
        />
        <input
          type="text"
          id="edit-support-end"
          placeholder="Support End Date"
          required
        />
        <input type="url" id="edit-url" placeholder="Website URL" required />
        <button id="update-project-btn">Save Changes</button>
      </div>
    </div>
  </body>
</html>
